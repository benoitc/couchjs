{so_specs, [{"couchjs", [
                "c_src/main.o",
                "c_src/http.o", 
                "c_src/utf8.o"
]}]}.

{port_envs, [
    
    {".*", "CFLAGS", "$CFLAGS -Wall -O2 -DXP_UNIX"},
    {".*", "LDFLAGS", "$LDFLAGS -lmozjs -lcurl"},
   
    {".*", "DRV_LDFLAGS", "$ERL_LDFLAGS"},
 
    %% Make sure to link -lstdc++ on linux or solaris
    {"(linux|solaris)", "LDFLAGS", "$LDFLAGS -lstdc++"},
     
    %% Solaris specific flags
    {"solaris.*-64$", "CFLAGS", "-m64"},
    {"solaris.*-64$", "LDFLAGS", "-m64"},
    
    %% freebsd 
    {"freebsd", "DRV_CFLAGS", "$CFLAGS -I/usr/local/include"},
    {"freebsd", "DRV_LDFLAGS", "$DRV_LDFLAGS -L/usr/local/lib"},
    
    %% OS X Leopard flags for 64-bit
    {"darwin9.*-64$", "CFLAGS", "-m64"},
    {"darwin9.*-64$", "LDFLAGS", "-arch x86_64"},
            
    %% OS X Snow Leopard flags for 32-bit
    {"darwin10.*-32$", "CFLAGS", "-m32"},
    {"darwin10.*-32$", "LDFLAGS", "-arch i386"}
    
]}.

{port_pre_script, {"make js", ""}}.
{port_cleanup_script, "make jsclean"}.
